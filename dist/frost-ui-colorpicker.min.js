!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e:e(t)}(window,(function(t){"use strict";if(!t)throw new Error("FrostUI-ColorPicker requires a Window.");if(!("UI"in t))throw new Error("FrostUI-ColorPicker requires FrostUI.");if(!("Color"in t))throw new Error("FrostUI-ColorPicker requires FrostColor.");const e=t.dom,s=t.UI,i=t.Color,o=t.document;class r extends s.BaseComponent{constructor(t,s){super(t,s);const i=e.getValue(this._node);"auto"===this._settings.format&&(this._settings.format=this._getFormat(i)),this._color=this._parseColor(i),!this._validColor&&this._settings.defaultColor&&(this._color=this._parseColor(this._settings.defaultColor)),this._native=this._settings.mobileNative&&!this._settings.alpha&&!this._settings.inline&&/Android|webOS|iPhone|iPad|iPod/i.test(navigator.userAgent);const o=e.closest(this._node,".input-group").shift();o&&(this._inputGroupColor=e.findOne(".input-group-color",o)),this._updateValue(),this._native?(this._renderNative(),this._eventsNative()):(this._render(),this._events(),this._colorAttributes(),this._refresh()),this._refreshDisabled()}disable(){return e.setAttribute(this._node,"disabled",!0),this._refreshDisabled(),this}dispose(){if(this._color=null,this._native)return this._disposeNative();this._popper&&(this._popper.destroy(),this._popper=null),e.removeEvent(this._node,"focus.ui.colorpicker"),e.removeEvent(this._node,"keydown.ui.colorpicker"),e.removeEvent(this._node,"input.ui.color"),e.removeEvent(this._node,"change.ui.color"),e.remove(this._menuNode),this._menuNode=null,this._container=null,this._saturation=null,this._saturationGuide=null,this._hue=null,this._hueGuide=null,this._alpha=null,this._alphaColor=null,this._alphaGuide=null,this._preview=null,this._previewColor=null,super.dispose()}enable(){return e.removeAttribute(this._node,"disabled"),this._refreshDisabled(),this}hide(){return this._settings.inline||this._animating||!e.isConnected(this._menuNode)||!e.triggerOne(this._node,"hide.ui.colorpicker")||(this._animating=!0,e.fadeOut(this._menuNode,{duration:this._settings.duration}).then(t=>{e.detach(this._menuNode),e.triggerEvent(this._node,"hidden.ui.colorpicker")}).catch(t=>{}).finally(t=>{this._animating=!1})),this}show(){return this._settings.inline||this._animating||e.isConnected(this._menuNode)||!this._isEditable()||!e.triggerOne(this._node,"show.ui.colorpicker")||(this._animating=!0,this._settings.appendTo?e.append(this._settings.appendTo,this._menuNode):e.after(this._node,this._menuNode),this.update(),e.fadeIn(this._menuNode,{duration:this._settings.duration}).then(t=>{e.triggerEvent(this._node,"shown.ui.colorpicker")}).catch(t=>{}).finally(t=>{this._animating=!1})),this}toggle(){return e.isConnected(this._menuNode)?this.hide():this.show()}update(){return this._settings.inline||this._popper.update(),this}}Object.assign(r.prototype,{darken(t){const e=this.getColor().darken(t);return this._setColor(e),this},getAlpha(){return this._color.getAlpha()},getBrightness(){return this._color.getBrightness()},getColor(){return this._color.clone()},getHue(){return this._color.getHue()},getSaturation(){return this._color.getSaturation()},invert(){const t=this.getColor().invert();return this._setColor(t),this},lighten(t){const e=this.getColor().lighten(t);return this._setColor(e),this},luma(){return this._color.luma()},setAlpha(t){if(this._settings.alpha){const e=this.getColor().setAlpha(t);this._setColor(e)}return this},setBrightness(t){const e=this.getColor().setBrightness(t);return this._setColor(e),this},setColor(t){return t=this._parseColor(t),this._settings.alpha||(t=t.setAlpha(1)),this._setColor(t),this},setHue(t){const e=this.getColor().setHue(t);return this._setColor(e),this},setSaturation(t){const e=this.getColor()._setColor(t);return this._setColor(e),this},shade(t){const e=this.getColor().shade(t);return this._setColor(e),this},tint(t){const e=this.getColor().tint(t);return this._setColor(e),this},tone(t){const e=this.getColor().tone(t);return this._setColor(e),this}}),Object.assign(r.prototype,{_events(){e.addEvent(this._menuNode,"contextmenu.ui.datetimepicker",t=>{t.preventDefault()}),e.addEvent(this._menuNode,"mousedown.ui.datetimepicker",t=>{this._settings.inline||t.preventDefault()}),e.addEvent(this._container,"click.ui.datetimepicker",t=>{t.stopPropagation()});const t=e.mouseDragFactory(t=>{if(t.button)return!1},t=>{this._updateSaturation(t.pageX,t.pageY)});e.addEvent(this._saturation,"click.ui.colorpicker",t=>{if(t.button)return!1;this._updateSaturation(t.pageX,t.pageY)}),e.addEvent(this._saturation,"mousedown.ui.colorpicker touchstart.ui.colorpicker",t);const s=e.mouseDragFactory(t=>{if(t.button)return!1},t=>{this._updateHue(t.pageX,t.pageY)});if(e.addEvent(this._hue,"click.ui.colorpicker",t=>{if(t.button)return!1;this._updateHue(t.pageX,t.pageY)}),e.addEvent(this._hue,"mousedown.ui.colorpicker touchstart.ui.colorpicker",s),this._settings.alpha){const t=e.mouseDragFactory(t=>{if(t.button)return!1},t=>{this._updateAlpha(t.pageX,t.pageY)});e.addEvent(this._alpha,"click.ui.colorpicker",t=>{if(t.button)return!1;this._updateAlpha(t.pageX,t.pageY)}),e.addEvent(this._alpha,"mousedown.ui.colorpicker touchstart.ui.colorpicker",t)}e.addEvent(this._node,"input.ui.color change.ui.color",t=>{const s=e.getValue(this._node),i=this._parseColor(s);this._validColor&&this._setColor(i)}),this._settings.inline||(e.addEvent(this._node,"blur.ui.datetimepicker",t=>{e.isSame(this._node,o.activeElement)||(e.stop(this._menuNode),this.hide())}),e.addEvent(this._node,"focus.ui.colorpicker",t=>{e.isSame(this._node,o.activeElement)&&(e.stop(this._menuNode),this.show())}),e.addEvent(this._node,"keydown.ui.colorpicker",t=>{"Enter"===t.code&&(t.preventDefault(),e.stop(this._menuNode),this.toggle())}),e.addEvent(this._node,"keyup.ui.colorpicker",t=>{"Escape"===t.code&&e.isConnected(this._menuNode)&&(t.stopPropagation(),e.stop(this._menuNode),this.hide())}))}}),Object.assign(r.prototype,{_colorAttributes(){this._values={alpha:this._settings.alpha?this._color.getAlpha():1,brightness:this._color.getBrightness(),hue:this._color.getHue(),saturation:this._color.getSaturation()}},_getFormat(t){if(!t)return null;if("#"===t.substring(0,1))return"hex";const e=t.substring(0,3);return["rgb","hsl"].includes(e)?e:null},_isEditable(){return!e.is(this._node,":disabled")&&(this._settings.ignoreReadonly||!e.is(this._node,":read-only"))},_parseColor(t){if(!t)return this._validColor=!1,new i;if(this._validColor=!0,t instanceof i)return i.fromString(""+t);try{return i.fromString(t)}catch(t){return this._validColor=!1,new i}},_refreshDisabled(){this._native||(e.is(this._node,":disabled")?e.addClass(this._menuNode,this.constructor.classes.disabled):e.removeClass(this._menuNode,this.constructor.classes.disabled))},_setColor(t,s=!0){this._isEditable()&&(e.triggerEvent(this._node,"change.ui.colorpicker",{detail:{old:this._color?this._color.clone():null,new:t?t.clone():null}}),this._validColor=!0,this._color=t,s&&this._colorAttributes(),this._updateValue(),this._refresh())},_updateAlpha(t,s){const i=this._settings.horizontal?e.percentX(this._alpha,t,!0,!0):e.percentY(this._alpha,s,!0,!0);this._values.alpha=1-i/100,this._updateColor()},_updateColor(){const t=this.getColor().setAlpha(this._values.alpha).setBrightness(this._values.brightness).setHue(this._values.hue).setSaturation(this._values.saturation);this._setColor(t,!1)},_updateHue(t,s){const i=this._settings.horizontal?e.percentX(this._hue,t,!0,!0):e.percentY(this._hue,s,!0,!0);this._values.hue=3.6*(100-i),this._updateColor()},_updateSaturation(t,s){this._values.brightness=100-e.percentY(this._saturation,s,!0,!0),this._values.saturation=e.percentX(this._saturation,t,!0,!0),this._updateColor()},_updateValue(){if(this._settings.keepInvalid&&!this._validColor)return;let t;switch(this._settings.format){case"hex":t=this._color.toHexString();break;case"rgb":t=this._color.toRGBString();break;case"hsl":t=this._color.toHSLString();break;default:t=""+this._color}e.setValue(this._node,t),this._native&&this._color&&this._updateNativeColor()}}),Object.assign(r.prototype,{_disposeNative(){const t=e.getAttribute(this._nativeInput,"id");t&&e.setAttribute(this._node,t),e.remove(this._nativeInput),e.show(this._node),super.dispose()},_eventsNative(){e.addEvent(this._nativeInput,"change.ui.colorpicker",t=>{const s=e.getValue(this._nativeInput),o=s?i.fromString(s):null;this._setColor(o)})},_renderNative(){const t={type:"color"},s=e.getAttribute(this._node,"id");s&&(t.id=s,e.removeAttribute(this._node,"id")),this._nativeInput=e.create("input",{class:e.getAttribute(this._node,"class"),attributes:t}),this._color&&this._updateNativeColor(),e.before(this._node,this._nativeInput),e.hide(this._node)},_updateNativeColor(){e.setValue(this._nativeInput,""+this._color)}}),Object.assign(r.prototype,{_refresh(){const t=i.fromHSV(this._values.hue,100,100);e.setStyle(this._saturation,{backgroundColor:t}),e.setStyle(this._saturationGuide,{top:100-this._values.brightness+"%",left:this._values.saturation+"%"});const s=100-this._values.hue/3.6+"%";if(this._settings.horizontal?e.setStyle(this._hueGuide,{left:s}):e.setStyle(this._hueGuide,{top:s}),this._settings.alpha){const t=i.fromHSV(this._values.hue,this._values.saturation,this._values.brightness);let s=this._settings.horizontal?"to right,":"";e.setStyle(this._alphaColor,{background:`linear-gradient(${s}${t} 0%, transparent 100%)`});const o=100-100*this._values.alpha+"%";this._settings.horizontal?e.setStyle(this._alphaGuide,{left:o}):e.setStyle(this._alphaGuide,{top:o})}e.setStyle(this._previewColor,{backgroundColor:this._color}),this._inputGroupColor&&e.setStyle(this._inputGroupColor,{backgroundColor:this._color})},_render(){this._menuNode=e.create("div",{class:this.constructor.classes.menu}),this._container=e.create("div",{class:this.constructor.classes.container}),e.append(this._menuNode,this._container),this._saturation=e.create("div",{class:this.constructor.classes.saturation}),e.append(this._container,this._saturation),this._saturationGuide=e.create("div",{class:this.constructor.classes.guide}),e.append(this._saturation,this._saturationGuide),this._hue=e.create("div",{class:this.constructor.classes.hue}),e.append(this._container,this._hue),this._hueGuide=e.create("div",{class:this.constructor.classes.guide}),e.append(this._hue,this._hueGuide),this._settings.alpha&&(this._alpha=e.create("div",{class:this.constructor.classes.alpha}),e.append(this._container,this._alpha),this._alphaColor=e.create("div",{class:this.constructor.classes.alphaColor}),e.append(this._alpha,this._alphaColor),this._alphaGuide=e.create("div",{class:this.constructor.classes.guide}),e.append(this._alpha,this._alphaGuide)),this._preview=e.create("div",{class:this.constructor.classes.preview}),e.append(this._menuNode,this._preview),this._previewColor=e.create("div"),e.append(this._preview,this._previewColor),this._settings.horizontal?(e.addClass(this._menuNode,this.constructor.classes.menuHorizontal),e.addClass(this._container,this.constructor.classes.containerHorizontal),e.addClass(this._hue,this.constructor.classes.spacingHorizontal),this._settings.alpha&&e.addClass(this._alpha,this.constructor.classes.spacingHorizontal)):(e.addClass(this._saturation,this.constructor.classes.spacingVertical),this._settings.alpha&&e.addClass(this._hue,this.constructor.classes.spacingVertical)),this._settings.inline?(e.addClass(this._menuNode,this.constructor.classes.menuInline),e.after(this._node,this._menuNode),e.hide(this._node)):(e.addClass(this._menuNode,this.constructor.classes.menuPadding),e.addClass(this._menuNode,this.constructor.classes.menuShadow),this._popper=new s.Popper(this._menuNode,{reference:this._node,placement:this._settings.placement,position:this._settings.position,fixed:this._settings.fixed,spacing:this._settings.spacing,minContact:this._settings.minContact}))}}),r.defaults={format:"auto",defaultColor:null,alpha:!0,inline:!1,horizontal:!1,keepInvalid:!0,ignoreReadonly:!1,mobileNative:!0,duration:100,appendTo:null,placement:"bottom",position:"start",fixed:!1,spacing:0,minContact:!1},r.classes={alpha:"colorpicker-alpha flex-grow-1",alphaColor:"colorpicker-alpha-color",container:"d-flex justify-content-between",containerHorizontal:"flex-column",disabled:"colorpicker-disabled",guide:"colorpicker-guide",hue:"colorpicker-hue flex-grow-1",menu:"colorpicker",menuHorizontal:"colorpicker-horizontal",menuInline:"colorpicker-inline",menuPadding:"p-2",menuShadow:"shadow-sm",preview:"colorpicker-bar colorpicker-preview mt-2",saturation:"colorpicker-saturation",spacingHorizontal:"mt-2",spacingVertical:"me-2"},s.initComponent("colorpicker",r),s.ColorPicker=r}));